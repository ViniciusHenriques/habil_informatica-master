<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<meta name="GENERATOR" content="PasDoc 0.11.0">
<title>TecnoSpeed NFe: spdNFELibrary</title>
<link rel="StyleSheet" type="text/css" href="pasdoc.css">
</head>
<body bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#800080" alink="#FF0000">
<h1 class="unit">Unit spdNFELibrary</h1>
<table class="sections wide_list">
<tr>
<td><a class="section"  href="#%40Description">Descrição</a></td><td><a class="section"  href="#%40Uses">uses</a></td><td>Classes, Interfaces, Objetos e Registros</td><td><a class="section"  href="#%40FuncsProcs">Funções e Procedimentos</a></td><td>Tipos</td><td>Constantes</td><td>Variáveis</td></tr></table>
<a name="%40Description"></a><h2 class="description">Descrição</h2>
<p>
Unit responsável pelo mapeamento das funcionalidades do componente <a class="normal"  href="spdNFe.TspdNFe.html">TspdNFE</a> para chamadas exportadas pela dll spdNFELib.dll  </p>
<a name="%40Uses"></a><h2 class="uses">uses</h2>
<ul class="useslist"><li>Windows</li><li><a   href="spdNFe.html">spdNFE</a></li><li><a   href="spdNFeSCAN.html">spdNFeSCAN</a></li><li><a   href="spdNFeDPEC.html">spdNFeDPEC</a></li><li><a   href="spdNFeUtils.html">spdNFEUtils</a></li><li>Classes</li><li>IniFiles</li><li>spdNFeConverter</li><li><a   href="spdNFeType.html">spdNFeType</a></li><li>SysUtils</li><li><a   href="spdNFeDataSets.html">spdNFeDataSets</a></li></ul><h2 class="overview">Visão Geral</h2>
<a name="%40FuncsProcs"></a><h3 class="summary">Funções e Procedimentos</h3>
<table class="summary wide_list">
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#AuditarXml">AuditarXml</a></b>(const aXml: PWideChar; const aDelimitador: PWideChar; const aServidor: PWideChar; const aExibirRegra, aExibirHtml : WordBool; const aParams, aConfigFilePath : PWideChar): PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#AssinarDPEC">AssinarDPEC</a></b>(aXmlDPEC : PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#EnviarDPEC">EnviarDPEC</a></b>(aDPECAssinado : PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ConsultarDPEC">ConsultarDPEC</a></b>(aTpConsulta : Integer; aParam : PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#AssinarNota">AssinarNota</a></b>(aXML : PWideChar; aConfigFilePath : PChar; tpEmis : Integer) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#GerarNotasAleatorias">GerarNotasAleatorias</a></b>(Qtde : Integer; CNPJ : PChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ConverterLoteParaXml">ConverterLoteParaXml</a></b>(ArquivoLoteTxt : PChar; aConfigFilePath : PChar; aTipoConversao : Integer; aVersaoEsquema : PChar; aLayoutConv : <a   href="spdNFeType.html#TLayoutConvKind">TLayoutConvKind</a> = lkTXTDic; aExportacao : boolean = false) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#StatusDoServico">StatusDoServico</a></b>(aConfigFilePath : PChar; tpEmis : Integer) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#CancelarNF">CancelarNF</a></b>(aNotaID, aNumProtocolo, aJustificativa : PChar;aConfigFilePath : PChar; tpEmis : Integer): PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ConsultarNF">ConsultarNF</a></b>(aNotaID : PChar;aConfigFilePath : PChar; tpEmis : Integer): PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#InutilizarNF">InutilizarNF</a></b>(aNotaID, aAno, aCNPJ ,aModelo : PChar; aSerie : PChar; aNFIni , aNFFin , aJustificativa ,aConfigFilePath : PChar; tpEmis : Integer): PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#EnviarNF">EnviarNF</a></b>(aNumLote : PChar; aLoteNotas : PWideChar; aCompactado : Boolean; aConfigFilePath : PChar; tpEmis : Integer): PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#EnviarNFSincrono">EnviarNFSincrono</a></b>(aNumLote : PChar; aLoteNota : PWideChar; aCompactado : Boolean; aConfigFilePath : PChar; tpEmis : Integer): PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ConsultarRecibo">ConsultarRecibo</a></b>(aNumRecibo : PChar;aConfigFilePath : PChar; tpEmis : Integer): PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ConsultarCadastro">ConsultarCadastro</a></b>(aDocumento : PChar; aTpDocumento : PChar; aUF : PChar; aConfigFilePath : PChar; tpEmis : Integer) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#VisualizarDanfe">VisualizarDanfe</a></b>(aNumLote : PChar;aLoteNotas : PWideChar; aArquivoModelo : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#ExportarPreverDanfe">ExportarPreverDanfe</a></b>(const aLoteNotas: PWideChar; aArquivoModelo : PWideChar; aLocalNomeArquivo : PWideChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#PreverDanfe">PreverDanfe</a></b>(aLoteNotas : PWideChar; aArquivoModelo : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#VisualizarDanfeDPEC">VisualizarDanfeDPEC</a></b>(aLoteNotas : PWideChar; aProtocoloDPEC : PChar; aDataHoraDPEC : PChar; aArquivoModelo : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#ImprimirDanfe">ImprimirDanfe</a></b>(aNumLote : PChar;aLoteNotas : PWideChar; aArquivoModelo : PChar; aConfigFilePath : PChar; aImpressora : PChar); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#ImprimirDanfeXmlDiretorio">ImprimirDanfeXmlDiretorio</a></b>(const aDiretorioXml: PChar; aArquivoModelo : PChar; const aExportarArquivoPara: PChar; const aImpressora : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#ImprimirDanfeDPEC">ImprimirDanfeDPEC</a></b>(aLoteNotas : PWideChar; aProtocoloDPEC : PChar; aDataHoraDPEC : PChar; aArquivoModelo : PChar; aConfigFilePath : PChar; aImpressora : PChar); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#EditarModeloDanfe">EditarModeloDanfe</a></b>(aNumLote : PChar;aLoteNotas : PWideChar; aArquivoModelo : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#EditarModeloDanfeDPEC">EditarModeloDanfeDPEC</a></b>(aLoteNotas : PWideChar; aProtocoloDPEC : PChar; aDataHoraDPEC : PChar; aArquivoModelo : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#ExportarDanfe">ExportarDanfe</a></b>(aNumLote : PChar;aLoteNotas: PWideChar;aArquivoModelo : PChar; aFormato : Integer;aConfigFilePath : PChar; aExportarParaArquivo : PChar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#ExportarDanfeDPEC">ExportarDanfeDPEC</a></b>(aLoteNotas: PWideChar; aProtocoloDPEC : PChar; aDataHoraDPEC : PChar; aArquivoModelo : PChar; aFormato : Integer;aConfigFilePath : PChar; aExportarParaArquivo : PChar); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ObterCertificados">ObterCertificados</a></b>(aConfigFilePath : PChar) : PwideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#RemoverCertificado">RemoverCertificado</a></b>(CertificateName : PCHAR) : BOOL; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#EmailDanfe">EmailDanfe</a></b>(aNumLote : PChar;aLoteNotas: PWideChar;aArquivoModelo : PChar;aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ConsultarDistribuicaoDFe">ConsultarDistribuicaoDFe</a></b>(aConfigFilePath : PChar; aCodigoUF : PChar; aCNPJCPF: PChar;aNSU : PChar; aTipoNSU : Integer) : PWideChar ; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#DescompactarXMLZip">DescompactarXMLZip</a></b>(const aXML: PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#RemoverAcentos">RemoverAcentos</a></b>(txt: PWideChar): PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ListarLogs">ListarLogs</a></b>(aFilter : integer; aCustomFilter : PCHAR; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#LerLog">LerLog</a></b>(aPathArquivoLog : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#VisualizarDanfeLog">VisualizarDanfeLog</a></b>(aPathArquivoLog : PChar;aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>Function <b><a   href="spdNFELibrary.html#CalculaChaveNFe">CalculaChaveNFe</a></b>(aDtEmissao : PChar; aUF : PChar; aCNPJ : PChar; aModelo : PChar; aSerie : PChar; aNRNota : PChar; aCodSistema : PChar; aTpEmis : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>Function <b><a   href="spdNFELibrary.html#GerarXMLEnvioDestinatario">GerarXMLEnvioDestinatario</a></b>(aIdNFe : PChar; aLogEnvLote : PChar; aLogConsRecibo : PChar; aSalvarComo : Pchar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#EnviarNotaDestinatario">EnviarNotaDestinatario</a></b>(aIDNFe : PChar; aLogEnvio : PChar; aLogRecibo : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#GerarXMLCancelamentoDestinatario">GerarXMLCancelamentoDestinatario</a></b>(aIDNFe : PChar; aContentLogPedCanc : PChar; aContentLogRetCanc : PChar; aSalvarComo :PChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#EnviarNotaCanceladaDestinatario">EnviarNotaCanceladaDestinatario</a></b>(aIDNFe : PChar; aLogPedCanc : PChar; aLogRetCanc : PChar; aEmailDestinatario : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#EnviarNotaDestinatarioAnexos">EnviarNotaDestinatarioAnexos</a></b>(aArquivoPDF : PChar; aArquivoXML : PChar; aOutros : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ValidarArquivoXmlDestinatario">ValidarArquivoXmlDestinatario</a></b>(const aXml : PWideChar; var aErrorList : PWideChar; aConfigFilePath : PChar) : boolean; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ConverteXmlparaDataSet">ConverteXmlparaDataSet</a></b>(const aXml: PWideChar; aVersaoEsquema : <a   href="spdNFeType.html#TVersaoEsquema">TVersaoEsquema</a>; aConfigFilePath : PChar): <a   href="spdNFeDataSets.TspdNFeDataSets.html">TspdNFeDataSets</a>; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#GetVencimentoCertificado">GetVencimentoCertificado</a></b>(const aConfigFilePath : PChar) : PWChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ValidaDanfeSimplificado">ValidaDanfeSimplificado</a></b>(aModeloDanfe : String;aModeloSimplificado : String; aDanfeSimplificado : Boolean): String;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#EnviarManifestacaoDestinatario">EnviarManifestacaoDestinatario</a></b>(aTpEvento: Integer; aNotaID, aCNPJCPF, aJustificativa, aDataHoraEvento,aFusoHorario,aConfigFilePath: PChar; aSequenciaEvento : integer; aCOrgao :PWideChar): PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ConsultarNFeDestinadas">ConsultarNFeDestinadas</a></b>(aIndNFe: Integer; aIndEmi: Integer; aUltNSU: PChar; aConfigFilePath : PChar): PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#CancelarNFeEventoIdLote">CancelarNFeEventoIdLote</a></b>(aNotaID:PChar; aNumProtocolo:PChar; aJustificativa:PChar; aDataHoraEvento:PChar; aFusoHorario:PChar; aConfigFilePath:PChar; aSequenciaEvento: integer; aIdLote:PChar): PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#CancelarNFeEvento">CancelarNFeEvento</a></b>(aNotaID:PChar; aNumProtocolo:PChar; aJustificativa:PChar; aDataHoraEvento:PChar; aFusoHorario:PChar; aConfigFilePath:PChar; aSequenciaEvento: integer; atpEmis : Integer = 1): PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#DownloadNFe">DownloadNFe</a></b>(aChaves: PWideChar; aConfigFilePath : PChar; aOrgao : PWideChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#ValidarLoteParaEnvio">ValidarLoteParaEnvio</a></b>(const aNumLote : PWideChar; aLoteNotas : PWideChar; aConfigFilePath: PWideChar ): PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#ValidarTamanhoArquivoEnvio">ValidarTamanhoArquivoEnvio</a></b> (aLoteNotas : PWideChar; aConfigFilePath : PWideChar ); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#EnviarCCe">EnviarCCe</a></b>(const aNotaID, aTextoCorrecao, aDataHoraEvento, aOrgao, aIdLote : PWideChar; aSequenciaEvento : integer; const aFusoHorario : PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#MontarEPEC">MontarEPEC</a></b>(const aIdLote, aXmlEnvio, aDHEvento, aFusoHorario, aConfigFilePath: PWideChar): PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#AssinarEPEC">AssinarEPEC</a></b>(const aXMLEpec,aConfigFilePath : PWideChar): PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#EnviarEPEC">EnviarEPEC</a></b>(const aXMLEpecAssinado,aConfigFilePath : PWideChar): PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#GerarXMLCCeDestinatario">GerarXMLCCeDestinatario</a></b>(aIDEvento: PWideChar; const aLogEvento,aLogRetEvento: PWideChar; aSalvarComo: PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#GerarXMLManifestoDestinatario">GerarXMLManifestoDestinatario</a></b>(aIDEvento: PWideChar; const aLogEvento,aLogRetEvento: PWideChar; aSalvarComo: PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#EnviarCCeDestinatario">EnviarCCeDestinatario</a></b>(const aCCe : PWideChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#ImprimirCCe">ImprimirCCe</a></b>(const aXmlCCe: PWideChar; const aImpressora : PWideChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#VisualizarCCe">VisualizarCCe</a></b>(const aXmlCCe: PWideChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#EditarModeloCCe">EditarModeloCCe</a></b>(const aXmlCCe: PWideChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#ExportarCCe">ExportarCCe</a></b>(const aXmlCCe: PWideChar; aSalvarComo: PWideChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#GerarXMLEPECDestinatario">GerarXMLEPECDestinatario</a></b>(aIDEvento: PWideChar; const aLogEvento,aLogRetEvento: PWideChar; aSalvarComo: PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#ImprimirEPEC">ImprimirEPEC</a></b>(aLoteNotas: PWideChar; aProtEPEC, aDataHoraEPEC : PChar; aArquivoModelo : PChar;aImpressora: PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#ExportarEPEC">ExportarEPEC</a></b>(aLoteNotas: PWideChar; aProtEPEC, aDataHoraEPEC: PChar; aArquivoModelo : PChar; aFormato : Integer; aExportarParaArquivo : PChar; aConfigFilePath : Pchar); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#VisualizarEPEC">VisualizarEPEC</a></b>(aLoteNotas : PWidechar; aProtEPEC, aDataHoraEPEC : Pchar; aArquivoModelo : Pchar; aConfigFilePath : Pchar); stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#GerarIdCCe">GerarIdCCe</a></b>(const aChaveNFe: PWideChar; aSeqEvento: integer; aConfigFilePath : PChar): PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#MontarXmlCCe">MontarXmlCCe</a></b>(const aChaveNFe, aTextoCorrecao, aDataHoraEvento, aOrgao: PWideChar; aSequenciaEvento: integer; const aFusoHorario: PWideChar; aConfigFilePath : Pchar): PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#AssinarCCe">AssinarCCe</a></b>(const aXmlCCe: PWideChar; aConfigFilePath : Pchar): PWideChar; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#LoadTemplate">LoadTemplate</a></b>(const aXMLFileName : PWidechar; aConfigFilePath : Pchar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#ValidarLoteItem">ValidarLoteItem</a></b>(const aNumLote, aLoteNotas: PWidechar; aConfigFilePath : Pchar); stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#EnviarPedidoProrrogacao">EnviarPedidoProrrogacao</a></b>(const aIdLote, aChaveNFe, aNumProtocolo : PWideChar; aDataHoraEvento, aOrgao, aTpEvento : PWideChar; const aSequenciaEvento : integer; aFusoHorario, aDelimiter : PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>procedure <b><a   href="spdNFELibrary.html#AdicionarItens">AdicionarItens</a></b>(aNumItens, aQtdeItens: PWideChar; aConfigFilePath : PChar);</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#CancelarPedidoProrrogacao">CancelarPedidoProrrogacao</a></b>(const aIdLote, aChaveNFe, aNumProtocolo, aDataHoraEvento, aTpEvento : PWideChar; const aSequenciaEvento : integer; aFusoHorario : PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#FormataErro">FormataErro</a></b>(aException : Exception): string; stdcall;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code>function <b><a   href="spdNFELibrary.html#GetUltimoErro">GetUltimoErro</a></b> : PWideChar; stdcall;</code></td>
</tr>
</table>
<h2 class="description">Descrição</h2>
<h3 class="detail">Funções e Procedimentos</h3>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="AuditarXml"></a><code>function <b>AuditarXml</b>(const aXml: PWideChar; const aDelimitador: PWideChar; const aServidor: PWideChar; const aExibirRegra, aExibirHtml : WordBool; const aParams, aConfigFilePath : PWideChar): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função para a validação do auditor fiscal         </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXml:</dt>
<dd>xml passado para a validação.</dd>
<dt>aDelimitador:</dt>
<dd>Delimitador necessário para a validação.</dd>
<dt>aServidor:</dt>
<dd>Necessário informar servidor para dar a resposta da validação.</dd>
<dt>aExibirRegra:</dt>
<dd>Exibição das regras de validação.</dd>
<dt>aExibirHtml:</dt>
<dd>Exibição da validação em HTML.</dd>
<dt>aParam:</dt>
<dd>parâmetro não necessário, somente para caso precise futuramente.</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">Retorna um tipo de validação dependendo das propriedades setadas.</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt>UNKNOWN</dt>
<dd>Quando o validadorClient não é instanciado.</dd>
<dt>UNKNOWN</dt>
<dd>Quando a comunicação com a validação falhar.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="AssinarDPEC"></a><code>function <b>AssinarDPEC</b>(aXmlDPEC : PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Assina digitalmente o XML (resumido da NFe específico para DPEC) que será enviado ao SEFAZ  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXMLDPEC</dt>
<dd>XML (resumido da NFe específico para DPEC) a ser assinado digitalmente</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EnviarDPEC"></a><code>function <b>EnviarDPEC</b>(aDPECAssinado : PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Envia um XML de DPEC assinado ao WebService de DPEC (Declaração prévia de Emissão em Contingência)  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aDPECAssinado</dt>
<dd>XML de DPEC Assinado</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ConsultarDPEC"></a><code>function <b>ConsultarDPEC</b>(aTpConsulta : Integer; aParam : PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Consulta o registro de um DPEC no WebService do Sefaz nacional   </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aTpConsulta</dt>
<dd>Tipo da Consulta que será executada [1-Chave da Nfe, 2-Número de Registro do DPEC]</dd>
<dt>aParam</dt>
<dd>nùmero do Documento de acordo com o primeiro parametro</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="AssinarNota"></a><code>function <b>AssinarNota</b>(aXML : PWideChar; aConfigFilePath : PChar; tpEmis : Integer) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Gera assinatura de cada Nota dentro do arquivo XML   </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXML</dt>
<dd>xml da Nota a ser assinado</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
<dt>atpEmis</dt>
<dd>Tipo de Emissão da Nota que será assinada. Utilize [1-NFe e 2-SCAN]</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="GerarNotasAleatorias"></a><code>function <b>GerarNotasAleatorias</b>(Qtde : Integer; CNPJ : PChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função que gera Notas Fiscais com numeração Aleatória, utilizado como Demonstração de uso do Componente. Este método será desabilitado nas próximas atualizações.    </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>Qtde</dt>
<dd>Quantidade de NF's que será gerada</dd>
<dt>CNPJ</dt>
<dd>CNPJ do Emitente</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">Xml da quantidade de NFs solicitada</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ConverterLoteParaXml"></a><code>function <b>ConverterLoteParaXml</b>(ArquivoLoteTxt : PChar; aConfigFilePath : PChar; aTipoConversao : Integer; aVersaoEsquema : PChar; aLayoutConv : <a   href="spdNFeType.html#TLayoutConvKind">TLayoutConvKind</a> = lkTXTDic; aExportacao : boolean = false) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função que converte um Lote de Nf's formato TXT para XML     de acordo com a Versão do Manual de Integração setada ao componente </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>ArquivoLoteTxt</dt>
<dd>arquivo com Lote de NF's em formato TXT</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
<dt>aTipoConversao</dt>
<dd>Tipo de conversão que será utilizada (1-Tx2 / 2-Rec)</dd>
<dt>aVersaoEsquema</dt>
<dd>Versão de esquema que será utilizada na conversão, caso o usuário passe vazio o componente utiliza a última</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">Lote de entrada convertido para formato XML</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="StatusDoServico"></a><code>function <b>StatusDoServico</b>(aConfigFilePath : PChar; tpEmis : Integer) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função que Verifica a situação do serviço WebService solicitado   </p>

<pre class="longcode">
    Ex:
     _Result := StatusDoServico; </pre>

<p></p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">XML com resultado da operação solicitada</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="CancelarNF"></a><code>function <b>CancelarNF</b>(aNotaID, aNumProtocolo, aJustificativa : PChar;aConfigFilePath : PChar; tpEmis : Integer): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função que envia solicitação de Cancelamento da NF      </p>

<pre class="longcode">
    Ex:
     _Result := CancelarNF(<span class="pascal_string">'098909012345555090290124509890223879820934212'</span>,<span class="pascal_string">'098950000123463'</span>,<span class="pascal_string">'emitente incorreto'</span>);</pre>

<p> </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNotaID</dt>
<dd>Chave de Identificação da NF</dd>
<dt>aNumProtocolo</dt>
<dd>Número do Protocolo de registro da NF, que deve conter exatamente 15 dígitos</dd>
<dt>aJustificativa</dt>
<dd>Texto (mínimo 15 dígitos) para descrição do Motivo de cancelamento da NF</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">XML com o resultado da operação solicitada</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeCheckParams.html">EspdNFeCheckParams</a></dt>
<dd>Levantada quando os parâmetros estiverem com acento ou diferentes do tamanho exigido.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ConsultarNF"></a><code>function <b>ConsultarNF</b>(aNotaID : PChar;aConfigFilePath : PChar; tpEmis : Integer): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função para consultar NF no servidor    </p>

<pre class="longcode">
    Ex:
     _Result := ConsultaNF(<span class="pascal_string">'098909012345555090290124509890223879820934212'</span>); </pre>

<p> </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNotaID</dt>
<dd>Chave de Identificação da NF</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">XML com o resultado da operação solicitada</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeCheckParams.html">EspdNFeCheckParams</a></dt>
<dd>Levantada quando os parâmetros estiverem com acento ou diferentes do tamanho exigido.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="InutilizarNF"></a><code>function <b>InutilizarNF</b>(aNotaID, aAno, aCNPJ ,aModelo : PChar; aSerie : PChar; aNFIni , aNFFin , aJustificativa ,aConfigFilePath : PChar; tpEmis : Integer): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função que solicita a Inutilização de Numeração.          </p>

<pre class="longcode">
    ex:
      Result := fNF.CancelarNF(<span class="pascal_string">'35080677917680004205550010000011450045364376'</span>,<span class="pascal_string">'135080000000001'</span>,<span class="pascal_string">'123456789123456'</span>); </pre>

<p> </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNotaID</dt>
<dd>Chave de Identificação da NF</dd>
<dt>aAno</dt>
<dd>Ano de inutilização da numeração</dd>
<dt>aCNPJ</dt>
<dd>CNPJ do emitente</dd>
<dt>aModelo</dt>
<dd>Modelo da NFe</dd>
<dt>aSérie</dt>
<dd>Série da NFe</dd>
<dt>aNFIni</dt>
<dd>Número da NFe inicial a ser inutilizada</dd>
<dt>aNFFin</dt>
<dd>Número da NFe final a ser inutilizada</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">XML contendo a mensagem do resultado da solicitação</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeCheckParams.html">EspdNFeCheckParams</a></dt>
<dd>Levantada quando os parâmetros estiverem com acento ou diferentes do tamanho exigido.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EnviarNF"></a><code>function <b>EnviarNF</b>(aNumLote : PChar; aLoteNotas : PWideChar; aCompactado : Boolean; aConfigFilePath : PChar; tpEmis : Integer): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função para Enviar Lote das NF's assinadas.      </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNumLote</dt>
<dd>Número de Identificação do Lote a ser enviado.</dd>
<dt>aLoteNotas</dt>
<dd>XML das NF's encapsuladas no Lote.</dd>
<dt>aCompactado</dt>
<dd>define se o XML de envio será compactado ou não</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">Xml contendo mensagem do resultado da solicitaçao.</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeCheckParams.html">EspdNFeCheckParams</a></dt>
<dd>Levantada quando os parâmetros estiverem com acento ou diferentes do tamanho exigido.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EnviarNFSincrono"></a><code>function <b>EnviarNFSincrono</b>(aNumLote : PChar; aLoteNota : PWideChar; aCompactado : Boolean; aConfigFilePath : PChar; tpEmis : Integer): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função para Enviar Lote das NF's assinadas.      </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNumLote</dt>
<dd>Número de Identificação do Lote a ser enviado.</dd>
<dt>aLoteNota</dt>
<dd>XML contendo somente uma NFe encapsulada no Lote.</dd>
<dt>aCompactado</dt>
<dd>define se o XML de envio será compactado ou não</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">Xml contendo mensagem do resultado da solicitaçao.</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeCheckParams.html">EspdNFeCheckParams</a></dt>
<dd>Levantada quando os parâmetros estiverem com acento ou diferentes do tamanho exigido.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ConsultarRecibo"></a><code>function <b>ConsultarRecibo</b>(aNumRecibo : PChar;aConfigFilePath : PChar; tpEmis : Integer): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função que verifica a Situação do Recibo (que pode conter várias NFs).    </p>

<pre class="longcode">
    ex:
     _Result := ConsultarRecibo(<span class="pascal_string">'009098765436527'</span>); </pre>

<p> </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNumRecibo</dt>
<dd>Número do Recibo que deve conter 15 dígitos.</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">Retorna Xml contendo mensagem do resultado da solicitação.</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeCheckParams.html">EspdNFeCheckParams</a></dt>
<dd>Levantada quando os parâmetros estiverem com acento ou diferentes do tamanho exigido.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ConsultarCadastro"></a><code>function <b>ConsultarCadastro</b>(aDocumento : PChar; aTpDocumento : PChar; aUF : PChar; aConfigFilePath : PChar; tpEmis : Integer) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função para consultar cadastro do Contribuinte      </p>

<pre class="longcode">
    ex:
     _Result := ConsultarCadastro(<span class="pascal_string">'0000000000000000'</span>); </pre>

<p></p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aDocumento</dt>
<dd>Documento a ser consultado</dd>
<dt>aTpDocumento</dt>
<dd>Tipo de Documento = (CNPJ, IE, CPF)</dd>
<dt>aUF</dt>
<dd>UF - Estado do Contribuinte que está sendo consultado</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">Retorna XML contendo mensaegm do resultado da solicitação.(Dados do Contribuinte)</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="VisualizarDanfe"></a><code>procedure <b>VisualizarDanfe</b>(aNumLote : PChar;aLoteNotas : PWideChar; aArquivoModelo : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite visualizar um documento DANFE de acordo com o XML passado como parametro   passar o XML Destinatário que contém os dados de Autorização da NFe.  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNumLote</dt>
<dd>Número de Identificação do Lote de notas a ser visualizado.</dd>
<dt>aLoteNotas</dt>
<dd>xml válido contendo Notas Fiscais eletrônicas (NFe). Em caso de Missão em FS passar somente o XMLAssinado, caso contrário</dd>
<dt>aArquivoModelo</dt>
<dd>caminho para arquivo de modelo do DANFE (extensão RTM), se deixar em branco será utilizado o modelo padrão, localizado no diretório de Templates, subdiretório Danfe</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ExportarPreverDanfe"></a><code>procedure <b>ExportarPreverDanfe</b>(const aLoteNotas: PWideChar; aArquivoModelo : PWideChar; aLocalNomeArquivo : PWideChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite Exportar um PDF de previsão de como será impresso um DANFE   </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aLoteNotas</dt>
<dd>XML de Notas Assinado</dd>
<dt>aArquivoModelo</dt>
<dd>caminho para arquivo de modelo do DANFE (extensão RTM), se deixar em branco será utilizado o modelo padrão, localizado no diretório de Templates, subdiretório Danfe</dd>
<dt>aLocalNomeArquivo</dt>
<dd>Local e Nome de onde o arquivo será salvo</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="PreverDanfe"></a><code>procedure <b>PreverDanfe</b>(aLoteNotas : PWideChar; aArquivoModelo : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite visualizar um documento DANFE de acordo com o XML passado como parametro   </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aLoteNotas</dt>
<dd>Lote de notas Assinadas</dd>
<dt>aArquivoModelo</dt>
<dd>caminho para arquivo de modelo do DANFE (extensão RTM), se deixar em branco será utilizado o modelo padrão, localizado no diretório de Templates, subdiretório Danfe</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="VisualizarDanfeDPEC"></a><code>procedure <b>VisualizarDanfeDPEC</b>(aLoteNotas : PWideChar; aProtocoloDPEC : PChar; aDataHoraDPEC : PChar; aArquivoModelo : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite visualizar um documento DANFE no padrão de Contingência em DPEC.     </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aLoteNotas</dt>
<dd>xml válido contendo Notas Fiscais eletrônicas (NFe) assinadas</dd>
<dt>aProtocoloDPEC</dt>
<dd>Numero do protocolo de registro do DPEC no Sefaz</dd>
<dt>aDataHoraDPEC</dt>
<dd>DataHorta de registro do DPEC no Sefaz</dd>
<dt>aArquivoModelo</dt>
<dd>caminho para arquivo de modelo do DANFE (extensão RTM), se deixar em branco será utilizado o modelo padrão, localizado no diretório de Templates, subdiretório Danfe</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ImprimirDanfe"></a><code>procedure <b>ImprimirDanfe</b>(aNumLote : PChar;aLoteNotas : PWideChar; aArquivoModelo : PChar; aConfigFilePath : PChar; aImpressora : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite imprimir um documento DANFE para o Lote de Notas passado como parâmetro em xml.   passar o XML Destinatário que contém os dados de Autorização da NFe.  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNumLote</dt>
<dd>Número de Identificação do Lote de notas a ser impresso.</dd>
<dt>aLoteNotas</dt>
<dd>xml válido contendo Notas Fiscais eletrônicas (NFe). Em caso de Missão em FS passar somente o XMLAssinado, caso contrário</dd>
<dt>aArquivoModelo</dt>
<dd>caminho para arquivo de modelo do DANFE (extensão RTM), se deixar em branco será utilizado o modelo padrão, localizado no diretório de Templates, subdiretório Danfe</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ImprimirDanfeXmlDiretorio"></a><code>procedure <b>ImprimirDanfeXmlDiretorio</b>(const aDiretorioXml: PChar; aArquivoModelo : PChar; const aExportarArquivoPara: PChar; const aImpressora : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite imprimir xmls que estão contidos dentro de um pasta.  .  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aDiretorioXml</dt>
<dd>Endereço do diretório de xmls a ser impresso.</dd>
<dt>aArquivoModelo</dt>
<dd>caminho para arquivo de modelo do DANFE (extensão RTM), se deixar em branco será utilizado o modelo padrão, localizado no diretório de Templates, subdiretório Danfe</dd>
<dt>aExportarArquivoPara</dt>
<dd>Exporta os arquivos pdf para este endereço.</dd>
<dt>aImpressora</dt>
<dd>Nome da impressora.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ImprimirDanfeDPEC"></a><code>procedure <b>ImprimirDanfeDPEC</b>(aLoteNotas : PWideChar; aProtocoloDPEC : PChar; aDataHoraDPEC : PChar; aArquivoModelo : PChar; aConfigFilePath : PChar; aImpressora : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite imprimir um documento DANFE no padrão de Contingência DPEC. O lote de notas deve ser um xml válido e obedecendo as regras no esquema env-lot.xsd     </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aLoteNotas</dt>
<dd>xml válido contendo Notas Fiscais eletrônicas (NFe)</dd>
<dt>aProtocoloDPEC</dt>
<dd>Numero do protocolo de registro do DPEC no Sefaz</dd>
<dt>aDataHoraDPEC</dt>
<dd>DataHorta de registro do DPEC no Sefaz</dd>
<dt>aArquivoModelo</dt>
<dd>caminho para arquivo de modelo do DANFE (extensão RTM), se deixar em branco será utilizado o modelo padrão, localizado no diretório de Templates, subdiretório Danfe</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EditarModeloDanfe"></a><code>procedure <b>EditarModeloDanfe</b>(aNumLote : PChar;aLoteNotas : PWideChar; aArquivoModelo : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite editar o modelo para impressão do DANFE. Para utilizar o modelo alterado, é necessário salvar o arquivo com extensão RTM e utilizá-lo nas chamadas de <a class="normal"  href="spdNFELibrary.html#VisualizarDanfe">VisualizarDanfe</a> e <a class="normal"  href="spdNFELibrary.html#ImprimirDanfe">ImprimirDanfe</a>. Os parâmetro do método são os mesmos dos citados, para permitir a edição de um relatório com os campos preenchidos   passar o XML Destinatário que contém os dados de Autorização da NFe.  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNumLote</dt>
<dd>Número de Identificação do Lote de notas a ser impresso.</dd>
<dt>aLoteNotas</dt>
<dd>xml válido contendo Notas Fiscais eletrônicas (NFe). Em caso de Missão em FS passar somente o XMLAssinado, caso contrário</dd>
<dt>aArquivoModelo</dt>
<dd>caminho para arquivo de modelo do DANFE (extensão RTM), se deixar em branco será utilizado o modelo padrão, localizado no diretório de Templates, subdiretório Danfe</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EditarModeloDanfeDPEC"></a><code>procedure <b>EditarModeloDanfeDPEC</b>(aLoteNotas : PWideChar; aProtocoloDPEC : PChar; aDataHoraDPEC : PChar; aArquivoModelo : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite editar o modelo para impressão do DANFE usando como base o padrão de Contigência DPEC, é necessário salvar o arquivo com extensão RTM e utilizá-lo nas chamadas de <a class="normal"  href="spdNFELibrary.html#VisualizarDanfe">VisualizarDanfe</a> e <a class="normal"  href="spdNFELibrary.html#ImprimirDanfe">ImprimirDanfe</a>. Os parâmetro do método são os mesmos dos citados, para permitir a edição de um relatório com os campos preenchidos     </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aLoteNotas</dt>
<dd>xml válido contendo Notas Fiscais eletrônicas (NFe)</dd>
<dt>aProtocoloDPEC</dt>
<dd>Numero do protocolo de registro do DPEC no Sefaz</dd>
<dt>aDataHoraDPEC</dt>
<dd>DataHorta de registro do DPEC no Sefaz</dd>
<dt>aArquivoModelo</dt>
<dd>caminho para arquivo de modelo do DANFE (extensão RTM), se deixar em branco será utilizado o modelo padrão, localizado no diretório de Templates, subdiretório Danfe</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ExportarDanfe"></a><code>procedure <b>ExportarDanfe</b>(aNumLote : PChar;aLoteNotas: PWideChar;aArquivoModelo : PChar; aFormato : Integer;aConfigFilePath : PChar; aExportarParaArquivo : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite exportar a DANFE para os formatos PDF e JPG.   passar o XML Destinatário que contém os dados de Autorização da NFe.   </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNumLote</dt>
<dd>número do lote da NFe</dd>
<dt>aLoteNotas</dt>
<dd>xml válido contendo Notas Fiscais eletrônicas (NFe). Em caso de Missão em FS passar somente o XMLAssinado, caso contrário</dd>
<dt>aArquivoModelo</dt>
<dd>caminho para arquivo de modelo do DANFE (extensão RTM), se deixar em branco será utilizado o modelo padrão, localizado no diretório de Templates, subdiretório Danfe, com o nome modelo.RTM</dd>
<dt>aFormato</dt>
<dd>valor inteiro que corresponde ao formato desejado. Escolha 1 para PDF e 2 para JPG. O valor padrão é 1.</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ExportarDanfeDPEC"></a><code>procedure <b>ExportarDanfeDPEC</b>(aLoteNotas: PWideChar; aProtocoloDPEC : PChar; aDataHoraDPEC : PChar; aArquivoModelo : PChar; aFormato : Integer;aConfigFilePath : PChar; aExportarParaArquivo : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite exportar a DANFE de contingência DPEC para os formatos PDF e JPG.      </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aLoteNotas</dt>
<dd>XML contendo a(s) NFe(s) assinada(s)</dd>
<dt>aProtocoloDPEC</dt>
<dd>Numero do protocolo de registro do DPEC no Sefaz</dd>
<dt>aDataHoraDPEC</dt>
<dd>DataHorta de registro do DPEC no Sefaz</dd>
<dt>aArquivoModelo</dt>
<dd>caminho para arquivo de modelo do DANFE (extensão RTM), se deixar em branco será utilizado o modelo padrão, localizado no diretório de Templates, subdiretório Danfe</dd>
<dt>aFormato</dt>
<dd>valor inteiro que corresponde ao formato desejado. Escolha 1 para PDF e 2 para JPG. O valor padrão é 1.</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ObterCertificados"></a><code>function <b>ObterCertificados</b>(aConfigFilePath : PChar) : PwideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Funcção que retorna uma lista de certificados instalados no Computador. </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="RemoverCertificado"></a><code>function <b>RemoverCertificado</b>(CertificateName : PCHAR) : BOOL; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Remove um certificado do sistema operacional </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>CertificateName</dt>
<dd>nome do certificado</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EmailDanfe"></a><code>procedure <b>EmailDanfe</b>(aNumLote : PChar;aLoteNotas: PWideChar;aArquivoModelo : PChar;aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite enviar a DANFE por email    </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNumLote</dt>
<dd>número do lote da NFe</dd>
<dt>aLoteNotas</dt>
<dd>XML contendo a(s) NFe(s) assinada(s)</dd>
<dt>aArquivoModelo</dt>
<dd>caminho para arquivo de modelo do DANFE (extensão RTM), se deixar em branco será utilizado o modelo padrão, localizado no diretório de Templates, subdiretório Danfe, com o nome modelo.RTM</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ConsultarDistribuicaoDFe"></a><code>function <b>ConsultarDistribuicaoDFe</b>(aConfigFilePath : PChar; aCodigoUF : PChar; aCNPJCPF: PChar;aNSU : PChar; aTipoNSU : Integer) : PWideChar ; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Consulta a Distribuição DF-e    </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aCodigoUF</dt>
<dd>Código da UF</dd>
<dt>aCNPJCPF</dt>
<dd>CPF ou CNPJ que requisita</dd>
<dt>aNSU</dt>
<dd>Número do NSU</dd>
<dt>aTipoNSU</dt>
<dd>Tipo do NSU, especifico ou ultimo</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="DescompactarXMLZip"></a><code>function <b>DescompactarXMLZip</b>(const aXML: PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função para descompactação de xml's zipados que podem ser provenientes por exemplo de consultas de distribuição DFe  @raise (<a class="normal"  href="spdNFeException.EspdNFeDescompactarXMLException.html">EspdNFeDescompactarXMLException</a> quando houver algum problema na tentativa de descompactação.)</p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXML</dt>
<dd>- String contendo o conteúdo do XML compactado.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="RemoverAcentos"></a><code>function <b>RemoverAcentos</b>(txt: PWideChar): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Remove a acentuação de uma String</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ListarLogs"></a><code>function <b>ListarLogs</b>(aFilter : integer; aCustomFilter : PCHAR; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Lista todos os logs ou filtra de acordo com o filtro passado em aFilter

<p>Os valores para filtro que podem ser passado em aFilter são:

<p>0: lista todos os arquivos XML. É o valor padrão. 1: lista arquivos de NFe 2: lfEnvLot lista arquivos de envio de lote de NFe 3: lfRec lista arquivos de recibo 4: lfPedRec lista arquivos de pedido do resultado do processamento do lote de NFe 5: lfProRec lista arquivos de resultado do processamento do lote de NFe 6: lfDen lista arquivos de denegação de uso 7: lfPedCan lista arquivos de pedido de cancelamento de NFe 8: lfCan lista arquivos de cancelamento de NFe 9: lfPedInu lista arquivos de pedido de inutilização de numeração 10: lfInu lista arquivos de inutilização de numeração 11: lfPedSit lista arquivos de pedido de consulta de situação atual da NFe 12: lfSit lista arquivos de situação atual da NF-e 13: lfPedSta lista arquivos de pedido de consulta de status do serviço 14: lfSta lista arquivos de status de serviço 15: lfCustom lista arquivos obtidos através de um filtro personalizado pelo usuário em aCustomFilter</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="LerLog"></a><code>function <b>LerLog</b>(aPathArquivoLog : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Lê o conteúdo do arquivo de log especificado em aPathArquivoLog e retorna o valor em uma WideString 

<p>Exemplo: </p>

<pre class="longcode">LerLog(PCHAR(<span class="pascal_string">'c:\NFE\log\0001-env-lot.xml'</span>))</pre>

<p></p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aPathArquivoLof</dt>
<dd>caminho completo para o arquivo do log.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="VisualizarDanfeLog"></a><code>procedure <b>VisualizarDanfeLog</b>(aPathArquivoLog : PChar;aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Abre o visualizador de DANFE com o arquivo especificado em aPathArquivoLog. O arquivo deve conter o XML de uma NFe enviada (arquivos com sufixo -env-lot.xml). 

<p>Exemplo: </p>

<pre class="longcode">VisualizarDanfeLog(PCHAR(<span class="pascal_string">'c:\NFE\log\0001-env-lot.xml'</span>))</pre>

<p></p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aPathArquivoLof</dt>
<dd>caminho completo para o arquivo do log.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="CalculaChaveNFe"></a><code>Function <b>CalculaChaveNFe</b>(aDtEmissao : PChar; aUF : PChar; aCNPJ : PChar; aModelo : PChar; aSerie : PChar; aNRNota : PChar; aCodSistema : PChar; aTpEmis : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função que calcula a Chave da NFe de Acordo com a versão do Manual de Integração configurado no arquivo INI.    @aModelo Modelo do Documento Fiscal que está sendo Emitido @aSerie Serieo do Documento Fiscal que está sendo Emitido @NRNota Número da Nota Fiscal registrada no sistema @CodSistema Número Identificador da NF dentro do banco de dados da empresa @TpEmis Tipo de Emissão da NFe (1-Normal, 2-FS, 3-SCAN, 4-DPEC, 5-FSDA), utilizado após regulamentação do Manual 4.0</p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aDtEmissao</dt>
<dd>Data de Emissão do Documento no formato YYYY-MM-DD</dd>
<dt>aUF</dt>
<dd>Código do Estado do Emissor da NFe</dd>
<dt>aCNPJ</dt>
<dd>CNPJ do Emitente contendo 14 dígitos</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="GerarXMLEnvioDestinatario"></a><code>Function <b>GerarXMLEnvioDestinatario</b>(aIdNFe : PChar; aLogEnvLote : PChar; aLogConsRecibo : PChar; aSalvarComo : Pchar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função que Retorna um XML no padrão do SEFAZ para envio da NFe ao Destinatário    @aSalvarComo Arquivo que será Salvo o XML montado a partir dos LOG´s</p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aIdNFe</dt>
<dd>Chave da Nota que será enviada</dd>
<dt>aLogEnvLote</dt>
<dd>Arquivo do LOG de Envio da NFe</dd>
<dt>aLogConsRecibo</dt>
<dd>Arquivo de LOG da Consulta do Recibo que enviou a NFe</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EnviarNotaDestinatario"></a><code>procedure <b>EnviarNotaDestinatario</b>(aIDNFe : PChar; aLogEnvio : PChar; aLogRecibo : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Envia Email para o Destinatário com 2 arquivos Anexos (1-PDF da Danfe, 2-XML da NFe no padrão SEFAZ). Os dados para Email serão carregados do arquivo config.INI.   </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aIdNFe</dt>
<dd>Chave da Nota que será enviada</dd>
<dt>aLogEnv</dt>
<dd>Arquivo do LOG de Envio da NFe</dd>
<dt>aLogRecibo</dt>
<dd>Arquivo de LOG da Consulta do Recibo que enviou a NFe</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="GerarXMLCancelamentoDestinatario"></a><code>function <b>GerarXMLCancelamentoDestinatario</b>(aIDNFe : PChar; aContentLogPedCanc : PChar; aContentLogRetCanc : PChar; aSalvarComo :PChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função que Retorna um XML de Cancelamento (destinatário) no padrão exigido pelo Sefaz    @aSalvarComo Arquivo que será Salvo o XML montado a partir dos LOG´s </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aIdNFe</dt>
<dd>Chave da Nota que será enviada</dd>
<dt>aContentLogPedCanc</dt>
<dd>Conteúdo do arquivo do LOG de Pedido de Cancelamento</dd>
<dt>aContentLogRetCanc</dt>
<dd>Conteúdo do arquivo do LOG de Retorno de Cancelamento</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EnviarNotaCanceladaDestinatario"></a><code>procedure <b>EnviarNotaCanceladaDestinatario</b>(aIDNFe : PChar; aLogPedCanc : PChar; aLogRetCanc : PChar; aEmailDestinatario : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Método que Monta um Xml de Cancelamento e envia por email ao (destinatário) no padrão exigido pelo Sefaz    @aEmailDestinatario Email do Destinatário para o qual será enviado o arquivo XML, caso deixe &quot;vazio&quot; o componente assumirá o valor setado nas propriedades de EmailSettings </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aIdNFe</dt>
<dd>Chave da Nota que será enviada</dd>
<dt>aLogPedCanc</dt>
<dd>Arquivo do LOG de Pedido de Cancelamento</dd>
<dt>aLogRetCanc</dt>
<dd>Arquivo do LOG de Retorno de Cancelamento</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EnviarNotaDestinatarioAnexos"></a><code>procedure <b>EnviarNotaDestinatarioAnexos</b>(aArquivoPDF : PChar; aArquivoXML : PChar; aOutros : PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Metodo responsavel pelo envio dos arquivos ao destinatario da nota   </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aArquivoPDF</dt>
<dd>Arquivo PDF da Danfe que será anexada</dd>
<dt>aArquivoXML</dt>
<dd>Arquivo padrão Sefaz de distribuição ao destinatário que será anexado no email.</dd>
<dt>aOutros</dt>
<dd>Qualquer outro arquivo que será anexado como por exemplo: PDF de boleto bancário</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ValidarArquivoXmlDestinatario"></a><code>function <b>ValidarArquivoXmlDestinatario</b>(const aXml : PWideChar; var aErrorList : PWideChar; aConfigFilePath : PChar) : boolean; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função utilizada para checar a integridade do XMLDestinatário   </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXml</dt>
<dd>Xml que será avaliado</dd>
<dt>aErrorList</dt>
<dd>Lista de Erros que foram encontrados na validação do XML</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ConverteXmlparaDataSet"></a><code>function <b>ConverteXmlparaDataSet</b>(const aXml: PWideChar; aVersaoEsquema : <a   href="spdNFeType.html#TVersaoEsquema">TVersaoEsquema</a>; aConfigFilePath : PChar): <a   href="spdNFeDataSets.TspdNFeDataSets.html">TspdNFeDataSets</a>; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função criada para conveter dados de um XML de NFe válido para um DataSet populado.  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXML</dt>
<dd>Conteúdo do arquivo xml</dd>
</dl>
<h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeDataSetException.html">EspdNFeDataSetException</a></dt>
<dd>Quando não conseguir conveter o xml para um dataset</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="GetVencimentoCertificado"></a><code>function <b>GetVencimentoCertificado</b>(const aConfigFilePath : PChar) : PWChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função utilizada para verificar a data de vencimento do certificado digital </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ValidaDanfeSimplificado"></a><code>function <b>ValidaDanfeSimplificado</b>(aModeloDanfe : String;aModeloSimplificado : String; aDanfeSimplificado : Boolean): String;</code></td>
</tr>
<tr><td colspan="1">
&nbsp;</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EnviarManifestacaoDestinatario"></a><code>function <b>EnviarManifestacaoDestinatario</b>(aTpEvento: Integer; aNotaID, aCNPJCPF, aJustificativa, aDataHoraEvento,aFusoHorario,aConfigFilePath: PChar; aSequenciaEvento : integer; aCOrgao :PWideChar): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função para o envio de Manifestação de Destinatário.  Desconhecimento da operação (tmdDesconhecimentoOperacao), Operação não Realizada (tmdOperacaoNaoRealizada) e Ciência da operação (tmdCienciaOperacao).        </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aTpEvento</dt>
<dd>tipo do evento que deseja enviar: Confirmação da operação (tmdConfimacaoOperacao),</dd>
<dt>aNotaID</dt>
<dd>Chave de Acesso da NF-e vinculada ao Evento.</dd>
<dt>aCNPJCPF</dt>
<dd>Informar o CNPJ ou o CPF do autor do Evento.</dd>
<dt>aJustificativa</dt>
<dd>Justificativa para manifestação.</dd>
<dt>aDataHoraEvento</dt>
<dd>Data e Hora do evento.</dd>
<dt>aSequencia</dt>
<dd>Número sequêncial do evento.</dd>
<dt>aFusoHorario</dt>
<dd>Fuso horário.</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">XML com o resultado da operação solicitada</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ConsultarNFeDestinadas"></a><code>function <b>ConsultarNFeDestinadas</b>(aIndNFe: Integer; aIndEmi: Integer; aUltNSU: PChar; aConfigFilePath : PChar): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função de &quot;Consulta da Relação de Documentos Destinados para um determinado CNPJ  2 para &quot;Idem anterior, incluindo as NF-e que também não tiveram a Ciência da Operação&quot;)  1 para &quot;Somente as NF-e emitidas por emissores / remetentes que não tenham a mesma raiz do CNPJ do destinatário (para excluir as notas fiscais de transferência entre filiais)&quot;)  consulta retornará unicamente as notas fiscais que tenham sido recepcionadas nos últimos 15 dias)  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aIndNFe</dt>
<dd>Indicador de NF-e consultada. Utilizar: (0 para &quot;Todas as NF-e&quot;; 1 para &quot;Somente as NF-e sem manifestação&quot;;</dd>
<dt>aIndEmi</dt>
<dd>Indicador do Emissor da NF-e. Utilizar: (0 para &quot;Todos os Emitentes / Remetentes&quot;;</dd>
<dt>aUltNSU</dt>
<dd>Último NSU recebido pela Empresa (Caso seja informado com zero, ou com um NSU muito antigo, a</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">XML com o resultado da operação solicitada</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="CancelarNFeEventoIdLote"></a><code>function <b>CancelarNFeEventoIdLote</b>(aNotaID:PChar; aNumProtocolo:PChar; aJustificativa:PChar; aDataHoraEvento:PChar; aFusoHorario:PChar; aConfigFilePath:PChar; aSequenciaEvento: integer; aIdLote:PChar): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função que envia solicitação de Cancelamento de uma NFe como um evento.                </p>

<pre class="longcode">
     Ex:
      _Result := CancelarNFeEvento(<span class="pascal_string">'098909012345555090290124509890223879820934212'</span>,<span class="pascal_string">'098950000123463'</span>,<span class="pascal_string">'emitente incorreto'</span>,
      <span class="pascal_string">'2012-05-15T15:30:30'</span>, <span class="pascal_numeric">1</span>, <span class="pascal_string">'-03:00'</span>);
  </pre>

<p></p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNotaID</dt>
<dd>Chave de Identificação da NF</dd>
<dt>aNumProtocolo</dt>
<dd>Número do Protocolo de registro da NF, que deve conter exatamente 15 dígitos</dd>
<dt>aJustificativa</dt>
<dd>Texto (mínimo 15 dígitos) para descrição do Motivo de cancelamento da NF</dd>
<dt>aDataHoraEvento</dt>
<dd>Data e Hora da Emissão do Evento Ex.: 2010-08-19T13:00:15</dd>
<dt>aFusoHorario</dt>
<dd>Fuso horário do local de envio. Ex.: -03:00</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
<dt>aSequenciaEvento</dt>
<dd>é o numero do evento</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">XML com o resultado da operação solicitada.</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosNumeroProtException.html">EspdNFeEventosNumeroProtException</a></dt>
<dd>Quando número do protocolo não é informado</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosFusoHorarioInvalidException.html">EspdNFeEventosFusoHorarioInvalidException</a></dt>
<dd>quando formato fuso horário informado é inválido.</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosDataHoraInvalidException.html">EspdNFeEventosDataHoraInvalidException</a></dt>
<dd>quando Data Hora informada é inválida.</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosUFInvalidException.html">EspdNFeEventosUFInvalidException</a></dt>
<dd>quando UF não é definida.</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosChaveInvalidException.html">EspdNFeEventosChaveInvalidException</a></dt>
<dd>quando Chave da NFe informada é inválida.</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosCodigoOrgaoInvalidException.html">EspdNFeEventosCodigoOrgaoInvalidException</a></dt>
<dd>quando código do orgão é inválido.</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosJustificativaInvalidException.html">EspdNFeEventosJustificativaInvalidException</a></dt>
<dd>quando justificativa informada é inválida</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="CancelarNFeEvento"></a><code>function <b>CancelarNFeEvento</b>(aNotaID:PChar; aNumProtocolo:PChar; aJustificativa:PChar; aDataHoraEvento:PChar; aFusoHorario:PChar; aConfigFilePath:PChar; aSequenciaEvento: integer; atpEmis : Integer = 1): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função que envia solicitação de Cancelamento de uma NFe como um evento.                  </p>

<pre class="longcode">
     Ex:
      _Result := CancelarNFeEvento(<span class="pascal_string">'098909012345555090290124509890223879820934212'</span>,<span class="pascal_string">'098950000123463'</span>,<span class="pascal_string">'emitente incorreto'</span>,
      <span class="pascal_string">'2012-05-15T15:30:30'</span>, <span class="pascal_numeric">1</span>, <span class="pascal_string">'-03:00'</span>,<span class="pascal_numeric">1</span>);
  </pre>

<p></p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNotaID</dt>
<dd>Chave de Identificação da NF</dd>
<dt>aNumProtocolo</dt>
<dd>Número do Protocolo de registro da NF, que deve conter exatamente 15 dígitos</dd>
<dt>aJustificativa</dt>
<dd>Texto (mínimo 15 dígitos) para descrição do Motivo de cancelamento da NF</dd>
<dt>aDataHoraEvento</dt>
<dd>Data e Hora da Emissão do Evento Ex.: 2010-08-19T13:00:15</dd>
<dt>aFusoHorario</dt>
<dd>Fuso horário do local de envio. Ex.: -03:00</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
<dt>aSequenciaEvento</dt>
<dd>é o numero do evento</dd>
<dt>aIdLote</dt>
<dd>ID do Lote da nota no qual o Cancelamento será vinculado.</dd>
<dt>atpEmis</dt>
<dd>Tipo de Emissão da nota fiscal. 1 = Normal e 2 = Scan. Com valor padrão de 1.</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">XML com o resultado da operação solicitada.</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosNumeroProtException.html">EspdNFeEventosNumeroProtException</a></dt>
<dd>Quando número do protocolo não é informado</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosFusoHorarioInvalidException.html">EspdNFeEventosFusoHorarioInvalidException</a></dt>
<dd>quando formato fuso horário informado é inválido.</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosDataHoraInvalidException.html">EspdNFeEventosDataHoraInvalidException</a></dt>
<dd>quando Data Hora informada é inválida.</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosUFInvalidException.html">EspdNFeEventosUFInvalidException</a></dt>
<dd>quando UF não é definida.</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosChaveInvalidException.html">EspdNFeEventosChaveInvalidException</a></dt>
<dd>quando Chave da NFe informada é inválida.</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosCodigoOrgaoInvalidException.html">EspdNFeEventosCodigoOrgaoInvalidException</a></dt>
<dd>quando código do orgão é inválido.</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosJustificativaInvalidException.html">EspdNFeEventosJustificativaInvalidException</a></dt>
<dd>quando justificativa informada é inválida</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="DownloadNFe"></a><code>function <b>DownloadNFe</b>(aChaves: PWideChar; aConfigFilePath : PChar; aOrgao : PWideChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função de &quot;Download NFe&quot; do servidor da Sefaz.       </p>

<pre class="longcode">
     Ex:
      _Result := DownloadNFe(<span class="pascal_string">'098909012345555090290124509890223879820934212,098909012345555090290124509890223879820934212'</span>);
  </pre>

<p></p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aChaves</dt>
<dd>Chave das NF-e que seja realizar download (Seperadas por vírgula)</dd>
<dt>aConfigFilePath</dt>
<dd>caminho para um arquivo ini com configurações</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">Retorna XML contendo mensaegm do resultado da solicitação.</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosCNPJInvalidException.html">EspdNFeEventosCNPJInvalidException</a></dt>
<dd>quando CNPJ configurado é inválido</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventosChaveInvalidException.html">EspdNFeEventosChaveInvalidException</a></dt>
<dd>quando pelo menos uma das chaves informadas é inválida</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeEventoDownloadLimitNotasException.html">EspdNFeEventoDownloadLimitNotasException</a></dt>
<dd>quando informado mais que 10 chaves</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ValidarLoteParaEnvio"></a><code>function <b>ValidarLoteParaEnvio</b>(const aNumLote : PWideChar; aLoteNotas : PWideChar; aConfigFilePath: PWideChar ): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Valida Lote de Notas, realizando vários procedimentos, desde verificação de assinatura, até validação do xml de acordo com o esquema requerido para envio das notas    </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNumLote</dt>
<dd>Número do lote de notas, para montagem do xml</dd>
<dt>aLoteNotas</dt>
<dd>Lote de Notas a ser avaliado</dd>
</dl>
<h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeSchemaNotFoundException.html">EspdNFeSchemaNotFoundException</a></dt>
<dd>Quando o XML não puder ser validado por não indicar o arquivo esquema</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeCheckParams.html">EspdNFeCheckParams</a></dt>
<dd>Levantada quando os parâmetros estiverem com acento ou diferentes do tamanho exigido.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ValidarTamanhoArquivoEnvio"></a><code>procedure <b>ValidarTamanhoArquivoEnvio</b> (aLoteNotas : PWideChar; aConfigFilePath : PWideChar ); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Valida o Tamanho máximo do XML de Envio baseado na configuração da propriedade MaxSizeLoteEnvio  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aLoteNotas</dt>
<dd>Lote de Notas a ser avaliado</dd>
</dl>
<h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeMaxSizeException.html">EspdNFeMaxSizeException</a></dt>
<dd>Quando o XML estiver com tamanho acima do permitido</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EnviarCCe"></a><code>function <b>EnviarCCe</b>(const aNotaID, aTextoCorrecao, aDataHoraEvento, aOrgao, aIdLote : PWideChar; aSequenciaEvento : integer; const aFusoHorario : PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
&nbsp;</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="MontarEPEC"></a><code>function <b>MontarEPEC</b>(const aIdLote, aXmlEnvio, aDHEvento, aFusoHorario, aConfigFilePath: PWideChar): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Monta o XML do evento EPEC a partir do xml de envio da nota       ou o xml estiver inválido </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aIdLote</dt>
<dd>identificador de controle do lote de envio do evento</dd>
<dt>aXmlEnvio</dt>
<dd>xml de envio da nota (tpemis=4)</dd>
<dt>aDHEvento</dt>
<dd>Data e Hora da Emissão do Evento. Ex.: 2010-08-19T13:00:15</dd>
<dt>aFusoHorario</dt>
<dd>Fuso horário do local de envio. Ex.: -03:00</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">o xml da nota</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdEventoCheckParams.html">EspdEventoCheckParams</a></dt>
<dd>caso algum parâmetro de entrada ou algum valor no XML</dd>
<dt><a class="normal"  href="spdNFeException.EspdEventosException.html">EspdEventosException</a></dt>
<dd>caso não consiga gerar o xml</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="AssinarEPEC"></a><code>function <b>AssinarEPEC</b>(const aXMLEpec,aConfigFilePath : PWideChar): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Assina o XML da nota a ser enviada em Modo EPEC    de assinatura</p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXMLEpec</dt>
<dd>xml da nota com tpemis 4 a ser assinada</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">o xml assinado</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdSignatureException.html">EspdSignatureException</a></dt>
<dd>caso ocorra algum problema durante o processo</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EnviarEPEC"></a><code>function <b>EnviarEPEC</b>(const aXMLEpecAssinado,aConfigFilePath : PWideChar): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Envia a nota em modo de contingência EPEC ao WebService da Sefaz    Web Service e não seja possível enviar a EPEC  o esquema antes do envio e o xml esteja inválido</p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXmlEPECAssinado</dt>
<dd>xml da nota em modo EPEC já assinado</dd>
</dl>
<h6 class="description_section">Retornos</h6>
<p class="return">xml de retorno do web service de recepção de evento da Sefaz</p><h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeException.html">EspdNFeException</a></dt>
<dd>caso ocorra algum problema de comunicação com o</dd>
<dt><a class="normal"  href="spdNFeException.EspdSchemaValidationException.html">EspdSchemaValidationException</a></dt>
<dd>caso esteja configurado para validar</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="GerarXMLCCeDestinatario"></a><code>function <b>GerarXMLCCeDestinatario</b>(aIDEvento: PWideChar; const aLogEvento,aLogRetEvento: PWideChar; aSalvarComo: PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função responsavel por gerar XML de CCe que deve ser enviado ao Destinatário    </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aIDEvento</dt>
<dd>Chave da CCe que deseja gerar o arquivo</dd>
<dt>aLogEvento</dt>
<dd>Conteúdo do Log de Envio da CCe</dd>
<dt>aLogRetEvento</dt>
<dd>Conteúdo do Log de Retorno da CCe</dd>
<dt>aSalvarComo</dt>
<dd>Caso informado esse parametro salva em arquivo o conteúdo gerado pela função</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="GerarXMLManifestoDestinatario"></a><code>function <b>GerarXMLManifestoDestinatario</b>(aIDEvento: PWideChar; const aLogEvento,aLogRetEvento: PWideChar; aSalvarComo: PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função responsavel por gerar XML de Manifestação que deve ser enviado ao Destinatário    </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aIDEvento</dt>
<dd>Chave da Manifestação que deseja gerar o arquivo</dd>
<dt>aLogEvento</dt>
<dd>Conteúdo do Log de Envio da Manifestação</dd>
<dt>aLogRetEvento</dt>
<dd>Conteúdo do Log de Retorno da Manifestação</dd>
<dt>aSalvarComo</dt>
<dd>Caso informado esse parametro salva em arquivo o conteúdo gerado pela função</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EnviarCCeDestinatario"></a><code>procedure <b>EnviarCCeDestinatario</b>(const aCCe : PWideChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Metodo que envia a CCe para o email do destinatário </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aCCe</dt>
<dd>aceita tanto o caminho do arquivo XML quanto a chave da CCe</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ImprimirCCe"></a><code>procedure <b>ImprimirCCe</b>(const aXmlCCe: PWideChar; const aImpressora : PWideChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite imprimir um documento CCe passado como parâmetro em xml.  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXmlCCe</dt>
<dd>XML válido contendo uma CCe</dd>
<dt>aImpressora</dt>
<dd>Nome da impressora a ser utilizada.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="VisualizarCCe"></a><code>procedure <b>VisualizarCCe</b>(const aXmlCCe: PWideChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite Prever como será impresso um DANFE </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXmlCCe</dt>
<dd>XML de CCe Assinado</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EditarModeloCCe"></a><code>procedure <b>EditarModeloCCe</b>(const aXmlCCe: PWideChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite editar o modelo para impressão da CCe. </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXmlCCe</dt>
<dd>XML válido contendo uma CCe.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ExportarCCe"></a><code>procedure <b>ExportarCCe</b>(const aXmlCCe: PWideChar; aSalvarComo: PWideChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite exportar a CCe para PDF.  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXmlCCe</dt>
<dd>XML válido contendo uma CCe.</dd>
<dt>aSalvarComo</dt>
<dd>Nome do arquivo a ser salvo.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="GerarXMLEPECDestinatario"></a><code>function <b>GerarXMLEPECDestinatario</b>(aIDEvento: PWideChar; const aLogEvento,aLogRetEvento: PWideChar; aSalvarComo: PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função responsavel por gerar XML de EPEC que deve ser enviado ao Destinatário    </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aIDEvento</dt>
<dd>Chave do EPEC que deseja gerar o arquivo</dd>
<dt>aLogEvento</dt>
<dd>Conteúdo do Log de Envio do EPEC</dd>
<dt>aLogRetEvento</dt>
<dd>Conteúdo do Log de Retorno do EPEC</dd>
<dt>aSalvarComo</dt>
<dd>Caso informado esse parametro salva em arquivo o conteúdo gerado pela função</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ImprimirEPEC"></a><code>procedure <b>ImprimirEPEC</b>(aLoteNotas: PWideChar; aProtEPEC, aDataHoraEPEC : PChar; aArquivoModelo : PChar;aImpressora: PChar; aConfigFilePath : PChar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Método utilizado para Imprimir a DANFE em contingência EPEC     </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aLoteNotas</dt>
<dd>Lote XML de NFe Assinado</dd>
<dt>aProtEPEC</dt>
<dd>Número de Protocolo obtido após envio ao WebService de EPEC</dd>
<dt>aDataHoraEPEC</dt>
<dd>Data e Hora de recebimento do EPEC no WebService</dd>
<dt>aArquivoModelo</dt>
<dd>Arquivo (rtm) de layot de impressão (opcional)</dd>
<dt>aImpressora</dt>
<dd>Nome da impressora registrada no windows, caso deseje omitir a tela de seleção de impressora no momento da impressão</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ExportarEPEC"></a><code>procedure <b>ExportarEPEC</b>(aLoteNotas: PWideChar; aProtEPEC, aDataHoraEPEC: PChar; aArquivoModelo : PChar; aFormato : Integer; aExportarParaArquivo : PChar; aConfigFilePath : Pchar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Método utilizado para Exportar a DANFE em contingência EPEC      </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aLoteNotas</dt>
<dd>Lote XML de NFe Assinado</dd>
<dt>aProtDPEC</dt>
<dd>Número de Protocolo obtido após envio ao WebService de EPEC</dd>
<dt>aDataHoraEPEC</dt>
<dd>Data e Hora de recebimento do EPEC no WebService</dd>
<dt>aArquivoModelo</dt>
<dd>Arquivo (rtm) de layot de impressão (opcional)</dd>
<dt>aFormato</dt>
<dd>Formato da exportação (1-PDF, 2-JPG)</dd>
<dt>aExportarParaArquivo</dt>
<dd>Nome completo do arquivo que será gerado</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="VisualizarEPEC"></a><code>procedure <b>VisualizarEPEC</b>(aLoteNotas : PWidechar; aProtEPEC, aDataHoraEPEC : Pchar; aArquivoModelo : Pchar; aConfigFilePath : Pchar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Método utilizado para Visualizar a DANFE em contingência EPEC    </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aLoteNotas</dt>
<dd>Lote XML de NFe Assinado</dd>
<dt>aProtEPEC</dt>
<dd>Número de Protocolo obtido após envio ao WebService de EPEC</dd>
<dt>aDataHoraEPEC</dt>
<dd>Data e Hora de recebimento do EPEC no WebService</dd>
<dt>aArquivoModelo</dt>
<dd>Arquivo (rtm) de layot de impressão (opcional)</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="GerarIdCCe"></a><code>function <b>GerarIdCCe</b>(const aChaveNFe: PWideChar; aSeqEvento: integer; aConfigFilePath : PChar): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Função que gera o ID da Carta de correção Eletrônica, que é usado para gerar o XML Destinatário da CCe.  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aChaveNFe</dt>
<dd>Chave na Nota.</dd>
<dt>aSeqEvento</dt>
<dd>Sequência do Evento.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="MontarXmlCCe"></a><code>function <b>MontarXmlCCe</b>(const aChaveNFe, aTextoCorrecao, aDataHoraEvento, aOrgao: PWideChar; aSequenciaEvento: integer; const aFusoHorario: PWideChar; aConfigFilePath : Pchar): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Permite montar o xml de envio da CCe.      </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aChaveNFe</dt>
<dd>Chave de Identificação da NF.</dd>
<dt>aTextoCorrecao</dt>
<dd>Texto (mínimo 15 dígitos) para descrição da correção.</dd>
<dt>aDataHoraEvento</dt>
<dd>Data e Hora da Emissão do Evento. Ex.: 2010-08-19T13:00:15</dd>
<dt>aOrgao</dt>
<dd>Código do Estado do Emissor da NFe.</dd>
<dt>aSequenciaEvento</dt>
<dd>Número do evento (sequencial)</dd>
<dt>aFusoHorario</dt>
<dd>Fuso horário do local de envio. Ex.: -03:00</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="AssinarCCe"></a><code>function <b>AssinarCCe</b>(const aXmlCCe: PWideChar; aConfigFilePath : Pchar): PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Assina o XML da CCe  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXmlCCe</dt>
<dd>xml da CCe a ser assinada</dd>
</dl>
<h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeException.html">EspdNFeException</a></dt>
<dd>Quando o campo Id não for encontrado para na fiscal.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="LoadTemplate"></a><code>function <b>LoadTemplate</b>(const aXMLFileName : PWidechar; aConfigFilePath : Pchar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Retorna um template de acordo com o nome de arquivo informado  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aXMLFileName</dt>
<dd>nome do arquivo template</dd>
</dl>
<h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdTemplateNotFoundException.html">EspdTemplateNotFoundException</a></dt>
<dd>Quando arquivo template não é encontrado.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ValidarLoteItem"></a><code>procedure <b>ValidarLoteItem</b>(const aNumLote, aLoteNotas: PWidechar; aConfigFilePath : Pchar); stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Valida Lote de Notas, realizando vários procedimentos, desde verificação de assinatura, até validação do xml de acordo com o esquema requerido para envio das notas    </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aNumLote</dt>
<dd>Número do lote de notas, para montagem do xml</dd>
<dt>aLoteNotas</dt>
<dd>Lote de Notas a ser avaliado</dd>
</dl>
<h6 class="description_section">Exceções</h6>
<dl class="exceptions_raised">
<dt><a class="normal"  href="spdNFeException.EspdNFeSchemaNotFoundException.html">EspdNFeSchemaNotFoundException</a></dt>
<dd>Quando o XML não puder ser validado por não indicar o arquivo esquema</dd>
<dt><a class="normal"  href="spdNFeException.EspdNFeCheckParams.html">EspdNFeCheckParams</a></dt>
<dd>Levantada quando os parâmetros estiverem com acento ou diferentes do tamanho exigido.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="EnviarPedidoProrrogacao"></a><code>function <b>EnviarPedidoProrrogacao</b>(const aIdLote, aChaveNFe, aNumProtocolo : PWideChar; aDataHoraEvento, aOrgao, aTpEvento : PWideChar; const aSequenciaEvento : integer; aFusoHorario, aDelimiter : PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Metodo responsavel pelo envio do Pedido de Prorrogação         </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aIdLote</dt>
<dd>Id do lote a ser enviado.</dd>
<dt>aChaveNFe</dt>
<dd>Chave da NF-e que possui os itens a serem prorrogados.</dd>
<dt>aNumProtocolo</dt>
<dd>Número do protocólo de autorização da NF-e a ser prorrogada.</dd>
<dt>aDataHoraEvento</dt>
<dd>Data e Hora da Emissão do Evento. Ex.: 2010-08-19T13:00:15</dd>
<dt>aOrgao</dt>
<dd>Código do Estado do Emissor da NFe.</dd>
<dt>aTpEvento</dt>
<dd>Tipo do evento EPP1=111500 ou EPP2=111501</dd>
<dt>aSequenciaEvento</dt>
<dd>Número do evento (sequencial)</dd>
<dt>aFusoHorario</dt>
<dd>Fuso horário do local de envio. Ex.: -03:00</dd>
<dt>aDelimiter</dt>
<dd>Delimitador utilizado para separar os itens dos parâmetros aNumItens e aQtdeItens.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="AdicionarItens"></a><code>procedure <b>AdicionarItens</b>(aNumItens, aQtdeItens: PWideChar; aConfigFilePath : PChar);</code></td>
</tr>
<tr><td colspan="1">
<p>
Método responsável para popular os dados pedido e quantidade, para utilização no método: <a class="normal"  href="spdNFELibrary.html#EnviarPedidoProrrogacao">EnviarPedidoProrrogacao</a>  </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aPedido:</dt>
<dd>número do Item</dd>
<dt>aQuantidade:</dt>
<dd>quantidade do Item</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="CancelarPedidoProrrogacao"></a><code>function <b>CancelarPedidoProrrogacao</b>(const aIdLote, aChaveNFe, aNumProtocolo, aDataHoraEvento, aTpEvento : PWideChar; const aSequenciaEvento : integer; aFusoHorario : PWideChar; aConfigFilePath : PChar) : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
<p>
Metodo responsavel pelo envio de Cancelamento do Pedido de Prorrogação        </p>
<h6 class="description_section">Parâmetros</h6>
<dl class="parameters">
<dt>aIdLote</dt>
<dd>Id do lote a ser enviado.</dd>
<dt>aChaveNFe</dt>
<dd>Chave da NF-e que possui Pedido de Prorrgação a ser cancelado.</dd>
<dt>aIdEvento</dt>
<dd>Chave do evento de Pedido de Prorrogação autorizado.</dd>
<dt>aNumProtocolo</dt>
<dd>Número do protocólo de autorização da NF-e a ser prorrogada.</dd>
<dt>aDataHoraEvento</dt>
<dd>Data e Hora da Emissão do Evento. Ex.: 2010-08-19T13:00:15</dd>
<dt>aTpEvento</dt>
<dd>Tipo do evento CEPP1=111502 ou CEPP2=111503</dd>
<dt>aSequenciaEvento</dt>
<dd>Número do evento (sequencial)</dd>
<dt>aFusoHorario</dt>
<dd>Fuso horário do local de envio. Ex.: -03:00</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="FormataErro"></a><code>function <b>FormataErro</b>(aException : Exception): string; stdcall;</code></td>
</tr>
<tr><td colspan="1">
&nbsp;</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="GetUltimoErro"></a><code>function <b>GetUltimoErro</b> : PWideChar; stdcall;</code></td>
</tr>
<tr><td colspan="1">
&nbsp;</td></tr>
</table>
<h2 class="authors">Autores</h2>
<ul class="authors">
<li>TecnoSpeed (<a   href="http://www.tecnospeed.com.br">www.tecnospeed.com.br</a>)</li>
<li>Copyright (c) 2008-2014, Tecnospeed TI</li>
</ul>
<hr noshade size="1"><span class="appinfo"><em>Gerado por <a  target="_parent" href="http://pasdoc.sourceforge.net/">PasDoc 0.11.0</a> as 2020-11-03 14:24:52</em>
</span>
</body></html>
